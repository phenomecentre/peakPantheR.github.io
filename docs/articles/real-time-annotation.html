<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Real Time Annotation • peakPantheR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Real Time Annotation">
<meta property="og:description" content="peakPantheR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">peakPantheR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting Started with the peakPantheR package</a>
    </li>
    <li>
      <a href="../articles/parallel-annotation.html">Parallel Annotation</a>
    </li>
    <li>
      <a href="../articles/peakPantheR-GUI.html">peakPantheR Graphical User Interface</a>
    </li>
    <li>
      <a href="../articles/real-time-annotation.html">Real Time Annotation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/phenomecentre/peakPantheR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="real-time-annotation_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Real Time Annotation</h1>
            
            <h4 data-toc-skip class="date">2020-10-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/phenomecentre/peakPantheR/blob/master/vignettes/real-time-annotation.Rmd" class="external-link"><code>vignettes/real-time-annotation.Rmd</code></a></small>
      <div class="hidden name"><code>real-time-annotation.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><p><strong>Package</strong>: <em><a href="https://bioconductor.org/packages/3.13/peakPantheR" class="external-link">peakPantheR</a></em><br><strong>Authors</strong>: Arnaud Wolfer<br></p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>Introduction</h1>
<p>The <code>peakPantheR</code> package is designed for the detection, integration and reporting of pre-defined features in MS files (<em>e.g. compounds, fragments, adducts, …</em>).</p>
<p>The <strong>Real Time Annotation</strong> is set to detect and integrate <strong>multiple</strong> compounds in <strong>one</strong> file at a time. It therefore can be deployed on a LC-MS instrument to integrate a set of pre-defined features (<em>e.g. spiked standards</em>) as soon as the acquisition of a sample is completed.</p>
<p>Using the <em><a href="https://bioconductor.org/packages/3.13/faahKO" class="external-link">faahKO</a></em> raw MS dataset as an example, this vignette will:</p>
<ul>
<li>Detail the <strong>Real Time Annotation</strong> concept</li>
<li>Apply the <strong>Real Time Annotation</strong> to a subset of pre-defined features in the <em><a href="https://bioconductor.org/packages/3.13/faahKO" class="external-link">faahKO</a></em> dataset</li>
</ul>
<div id="abbreviations" class="section level2">
<h2 class="hasAnchor">
<a href="#abbreviations" class="anchor" aria-hidden="true"></a>Abbreviations</h2>
<ul>
<li>
<strong>ROI</strong>: <em>Regions Of Interest</em>
<ul>
<li>reference <em>RT</em> / <em>m/z</em> windows in which to search for a feature</li>
</ul>
</li>
<li>
<strong>uROI</strong>: <em>updated Regions Of Interest</em>
<ul>
<li>modifed ROI adapted to the current dataset which override the reference ROI</li>
</ul>
</li>
<li>
<strong>FIR</strong>: <em>Fallback Integration Regions</em>
<ul>
<li>
<em>RT</em> / <em>m/z</em> window to integrate if no peak is found</li>
</ul>
</li>
<li>
<strong>TIC</strong>: <em>Total Ion Chromatogram</em>
<ul>
<li>the intensities summed across all masses for each scan</li>
</ul>
</li>
<li>
<strong>EIC</strong>: <em>Extracted Ion Chromatogram</em>
<ul>
<li>the intensities summed over a mass range, for each scan</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="real-time-annotation-concept" class="section level1">
<h1 class="hasAnchor">
<a href="#real-time-annotation-concept" class="anchor" aria-hidden="true"></a>Real Time Annotation Concept</h1>
<p>Real time compound integration is set to process <strong>multiple</strong> compounds in <strong>one</strong> file at a time.</p>
<p>To achieve this, <code>peakPantheR</code> will:</p>
<ul>
<li>load a list of expected <em>RT</em> / <em>m/z</em> regions of interest (<strong>ROI</strong>)</li>
<li>detect features in each ROI and keep the highest intensity one</li>
<li>determine peak statistics for each feature</li>
<li>return:
<ul>
<li>TIC</li>
<li>a table with all detected compounds for that file (<em>row: compound, col: statistic</em>)</li>
<li>EIC for each ROI</li>
<li>sample acquisition date-time from the mzML metadata (<em>if available</em>)</li>
<li>save EIC plots to disk</li>
</ul>
</li>
</ul>
</div>
<div id="real-time-annotation-example" class="section level1">
<h1 class="hasAnchor">
<a href="#real-time-annotation-example" class="anchor" aria-hidden="true"></a>Real Time Annotation Example</h1>
<p>In the following example we will target two pre-defined features in a single raw MS spectra file from the <em><a href="https://bioconductor.org/packages/3.13/faahKO" class="external-link">faahKO</a></em> package. For more details on the installation and input data employed, please consult the <a href="getting-started.html">Getting Started with peakPantheR</a> vignette.</p>
<div id="input-data" class="section level2">
<h2 class="hasAnchor">
<a href="#input-data" class="anchor" aria-hidden="true"></a>Input Data</h2>
<p>The path to a MS file from the <em><a href="https://bioconductor.org/packages/3.13/faahKO" class="external-link">faahKO</a></em> is located and used as input spectra:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.doi.org/10.1021/bi0480335" class="external-link">faahKO</a></span><span class="op">)</span>
<span class="co">## file paths</span>
<span class="va">input_spectraPath</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'cdf/KO/ko15.CDF'</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span><span class="op">)</span>
<span class="va">input_spectraPath</span>
<span class="co">#&gt; [1] "C:/R/R-4.1.0/library/faahKO/cdf/KO/ko15.CDF"</span></code></pre></div>
<p>Two targeted features (<em>e.g. compounds, fragments, adducts, …</em>) are defined and stored in a table with as columns:</p>
<ul>
<li>
<code>cpdID</code> (numeric)</li>
<li>
<code>cpdName</code> (character)</li>
<li>
<code>rtMin</code> (sec)</li>
<li>
<code>rtMax</code> (sec)</li>
<li>
<code>rt</code> (sec, optional / <code>NA</code>)</li>
<li>
<code>mzMin</code> (m/z)</li>
<li>
<code>mzMax</code> (m/z)</li>
<li>
<code>mz</code> (m/z, optional / <code>NA</code>)</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># targetFeatTable</span>
<span class="va">input_targetFeatTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">8</span>, dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, 
                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cpdID"</span>, <span class="st">"cpdName"</span>, <span class="st">"rtMin"</span>, <span class="st">"rt"</span>, <span class="st">"rtMax"</span>, <span class="st">"mzMin"</span>, 
                        <span class="st">"mz"</span>, <span class="st">"mzMax"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">input_targetFeatTable</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID-1"</span>, <span class="st">"Cpd 1"</span>, <span class="fl">3310.</span>, <span class="fl">3344.888</span>, <span class="fl">3390.</span>, 
                                <span class="fl">522.194778</span>, <span class="fl">522.2</span>, <span class="fl">522.205222</span><span class="op">)</span>
<span class="va">input_targetFeatTable</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID-2"</span>, <span class="st">"Cpd 2"</span>, <span class="fl">3280.</span>, <span class="fl">3385.577</span>, <span class="fl">3440.</span>, 
                                <span class="fl">496.195038</span>, <span class="fl">496.2</span>, <span class="fl">496.204962</span><span class="op">)</span>
<span class="va">input_targetFeatTable</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">input_targetFeatTable</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>, 
                                            <span class="va">as.numeric</span><span class="op">)</span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="10%">
<col width="12%">
<col width="10%">
<col width="13%">
<col width="10%">
<col width="16%">
<col width="10%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="center">cpdID</th>
<th align="center">cpdName</th>
<th align="center">rtMin</th>
<th align="center">rt</th>
<th align="center">rtMax</th>
<th align="center">mzMin</th>
<th align="center">mz</th>
<th align="center">mzMax</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">ID-1</td>
<td align="center">Cpd 1</td>
<td align="center">3310</td>
<td align="center">3344.888</td>
<td align="center">3390</td>
<td align="center">522.194778</td>
<td align="center">522.2</td>
<td align="center">522.205222</td>
</tr>
<tr class="even">
<td align="center">ID-2</td>
<td align="center">Cpd 2</td>
<td align="center">3280</td>
<td align="center">3385.577</td>
<td align="center">3440</td>
<td align="center">496.195038</td>
<td align="center">496.2</td>
<td align="center">496.204962</td>
</tr>
</tbody>
</table>
</div>
<div id="run-single-file-annotation" class="section level2">
<h2 class="hasAnchor">
<a href="#run-single-file-annotation" class="anchor" aria-hidden="true"></a>Run Single File Annotation</h2>
<p><code><a href="../reference/peakPantheR_singleFileSearch.html">peakPantheR_singleFileSearch()</a></code> takes as input a <code>singleSpectraDataPath</code> pointing to the file to process and <code>targetFeatTable</code> defining the features to integrate. The resulting annotation contains all the fitting and integration properties:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/phenomecentre/peakPantheR" class="external-link">peakPantheR</a></span><span class="op">)</span>
<span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peakPantheR_singleFileSearch.html">peakPantheR_singleFileSearch</a></span><span class="op">(</span>
                                    singleSpectraDataPath <span class="op">=</span> <span class="va">input_spectraPath</span>,
                                    targetFeatTable <span class="op">=</span> <span class="va">input_targetFeatTable</span>,
                                    peakStatistic <span class="op">=</span> <span class="cn">TRUE</span>,
                                    curveModel <span class="op">=</span> <span class="st">'skewedGaussian'</span>,
                                    verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span>
<span class="co">#&gt; Reading data from 2 windows</span>
<span class="co">#&gt; Data read in: 3.05 secs</span>
<span class="co">#&gt; Warning: rtMin/rtMax outside of ROI; datapoints cannot be used for mzMin/mzMax calculation, approximate mz and returning ROI$mzMin and ROI$mzMax for ROI #1</span>
<span class="co">#&gt; Found 2/2 features in 0.15 secs</span>
<span class="co">#&gt; Peak statistics done in: 0.02 secs</span>
<span class="co">#&gt; Feature search done in: 4.77 secs</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annotation</span><span class="op">$</span><span class="va">TIC</span>
<span class="co">#&gt; [1] 2410533091</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## acquisition time cannot be extracted from NetCDF files</span>
<span class="va">annotation</span><span class="op">$</span><span class="va">acquTime</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annotation</span><span class="op">$</span><span class="va">peakTable</span></code></pre></div>
<table style="width:99%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="11%">
<col width="15%">
<col width="15%">
<col width="15%">
<col width="15%">
<col width="11%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="center">found</th>
<th align="center">rtMin</th>
<th align="center">rt</th>
<th align="center">rtMax</th>
<th align="center">mzMin</th>
<th align="center">mz</th>
<th align="center">mzMax</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">TRUE</td>
<td align="center">3309.759</td>
<td align="center">3346.828</td>
<td align="center">3385.41</td>
<td align="center">522.1948</td>
<td align="center">522.2</td>
<td align="center">522.2052</td>
</tr>
<tr class="even">
<td align="center">TRUE</td>
<td align="center">3345.377</td>
<td align="center">3386.529</td>
<td align="center">3428.279</td>
<td align="center">496.2</td>
<td align="center">496.2</td>
<td align="center">496.2</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="14%">
<col width="17%">
<col width="21%">
<col width="23%">
<col width="10%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">peakArea</th>
<th align="center">peakAreaRaw</th>
<th align="center">maxIntMeasured</th>
<th align="center">maxIntPredicted</th>
<th align="center">cpdID</th>
<th align="center">cpdName</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">26133727</td>
<td align="center">26071378</td>
<td align="center">889280</td>
<td align="center">901015.8</td>
<td align="center">ID-1</td>
<td align="center">Cpd 1</td>
</tr>
<tr class="even">
<td align="center">35472141</td>
<td align="center">36498367</td>
<td align="center">1128960</td>
<td align="center">1113577</td>
<td align="center">ID-2</td>
<td align="center">Cpd 2</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="16%">
<col width="18%">
<col width="18%">
<col width="22%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="center">is_filled</th>
<th align="center">ppm_error</th>
<th align="center">rt_dev_sec</th>
<th align="center">tailingFactor</th>
<th align="center">asymmetryFactor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">FALSE</td>
<td align="center">0.02337616</td>
<td align="center">1.939759</td>
<td align="center">1.015357</td>
<td align="center">1.026824</td>
</tr>
<tr class="even">
<td align="center">FALSE</td>
<td align="center">0.02460103</td>
<td align="center">0.9518072</td>
<td align="center">1.005378</td>
<td align="center">1.009318</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annotation</span><span class="op">$</span><span class="va">curveFit</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; $amplitude</span>
<span class="co">#&gt; [1] 162404.8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $center</span>
<span class="co">#&gt; [1] 3341.888</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sigma</span>
<span class="co">#&gt; [1] 0.07878613</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $gamma</span>
<span class="co">#&gt; [1] 0.00183361</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fitStatus</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $curveModel</span>
<span class="co">#&gt; [1] "skewedGaussian"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "peakPantheR_curveFit"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; $amplitude</span>
<span class="co">#&gt; [1] 199249.1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $center</span>
<span class="co">#&gt; [1] 3382.577</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sigma</span>
<span class="co">#&gt; [1] 0.07490442</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $gamma</span>
<span class="co">#&gt; [1] 0.00114719</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fitStatus</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $curveModel</span>
<span class="co">#&gt; [1] "skewedGaussian"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "peakPantheR_curveFit"</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annotation</span><span class="op">$</span><span class="va">ROIsDataPoint</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;          rt    mz    int</span>
<span class="co">#&gt; 1  3315.154 522.2   2187</span>
<span class="co">#&gt; 2  3316.719 522.2   3534</span>
<span class="co">#&gt; 3  3318.284 522.2   6338</span>
<span class="co">#&gt; 4  3319.849 522.2  11718</span>
<span class="co">#&gt; 5  3321.414 522.2  21744</span>
<span class="co">#&gt; 6  3322.979 522.2  37872</span>
<span class="co">#&gt; 7  3324.544 522.2  62424</span>
<span class="co">#&gt; 8  3326.109 522.2  98408</span>
<span class="co">#&gt; 9  3327.673 522.2 152896</span>
<span class="co">#&gt; 10 3329.238 522.2 225984</span>
<span class="co">#&gt; 11 3330.803 522.2 308672</span>
<span class="co">#&gt; 12 3332.368 522.2 399360</span>
<span class="co">#&gt; 13 3333.933 522.2 504000</span>
<span class="co">#&gt; 14 3335.498 522.2 614656</span>
<span class="co">#&gt; 15 3337.063 522.2 711872</span>
<span class="co">#&gt; 16 3338.628 522.2 784704</span>
<span class="co">#&gt; 17 3340.193 522.2 836608</span>
<span class="co">#&gt; 18 3341.758 522.2 866304</span>
<span class="co">#&gt; 19 3343.323 522.2 882304</span>
<span class="co">#&gt; 20 3344.888 522.2 889280</span>
<span class="co">#&gt; 21 3346.453 522.2 888256</span>
<span class="co">#&gt; 22 3348.018 522.2 866816</span>
<span class="co">#&gt; 23 3349.583 522.2 827392</span>
<span class="co">#&gt; 24 3351.148 522.2 777728</span>
<span class="co">#&gt; 25 3352.713 522.2 727040</span>
<span class="co">#&gt; 26 3354.278 522.2 678464</span>
<span class="co">#&gt; 27 3355.843 522.2 629120</span>
<span class="co">#&gt; 28 3357.408 522.2 578048</span>
<span class="co">#&gt; 29 3358.973 522.2 524288</span>
<span class="co">#&gt; 30 3360.538 522.2 471040</span>
<span class="co">#&gt; 31 3362.102 522.2 416320</span>
<span class="co">#&gt; 32 3363.667 522.2 360064</span>
<span class="co">#&gt; 33 3365.232 522.2 302400</span>
<span class="co">#&gt; 34 3366.797 522.2 249152</span>
<span class="co">#&gt; 35 3368.362 522.2 202560</span>
<span class="co">#&gt; 36 3369.927 522.2 161024</span>
<span class="co">#&gt; 37 3371.492 522.2 123520</span>
<span class="co">#&gt; 38 3373.057 522.2  93160</span>
<span class="co">#&gt; 39 3374.622 522.2  71856</span>
<span class="co">#&gt; 40 3376.187 522.2  58392</span>
<span class="co">#&gt; 41 3377.752 522.2  51072</span>
<span class="co">#&gt; 42 3379.317 522.2  48376</span>
<span class="co">#&gt; 43 3380.882 522.2  49168</span>
<span class="co">#&gt; 44 3382.447 522.2  53120</span>
<span class="co">#&gt; 45 3384.012 522.2  62488</span>
<span class="co">#&gt; 46 3385.577 522.2  78680</span>
<span class="co">#&gt; 47 3387.142 522.2 102840</span>
<span class="co">#&gt; 48 3388.707 522.2 134656</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;          rt    mz     int</span>
<span class="co">#&gt; 1  3280.725 496.2    1349</span>
<span class="co">#&gt; 2  3290.115 496.2    2069</span>
<span class="co">#&gt; 3  3291.680 496.2    3103</span>
<span class="co">#&gt; 4  3293.245 496.2    5570</span>
<span class="co">#&gt; 5  3294.809 496.2   10730</span>
<span class="co">#&gt; 6  3296.374 496.2   20904</span>
<span class="co">#&gt; 7  3297.939 496.2   38712</span>
<span class="co">#&gt; 8  3299.504 496.2   64368</span>
<span class="co">#&gt; 9  3301.069 496.2   97096</span>
<span class="co">#&gt; 10 3302.634 496.2  136320</span>
<span class="co">#&gt; 11 3304.199 496.2  182080</span>
<span class="co">#&gt; 12 3305.764 496.2  233472</span>
<span class="co">#&gt; 13 3307.329 496.2  288064</span>
<span class="co">#&gt; 14 3308.894 496.2  341248</span>
<span class="co">#&gt; 15 3310.459 496.2  386560</span>
<span class="co">#&gt; 16 3312.024 496.2  419648</span>
<span class="co">#&gt; 17 3313.589 496.2  441344</span>
<span class="co">#&gt; 18 3315.154 496.2  454592</span>
<span class="co">#&gt; 19 3316.719 496.2  459776</span>
<span class="co">#&gt; 20 3318.284 496.2  456320</span>
<span class="co">#&gt; 21 3319.849 496.2  444736</span>
<span class="co">#&gt; 22 3321.414 496.2  425408</span>
<span class="co">#&gt; 23 3322.979 496.2  397888</span>
<span class="co">#&gt; 24 3324.544 496.2  365952</span>
<span class="co">#&gt; 25 3326.109 496.2  329856</span>
<span class="co">#&gt; 26 3327.673 496.2  288832</span>
<span class="co">#&gt; 27 3329.238 496.2  244864</span>
<span class="co">#&gt; 28 3330.803 496.2  207616</span>
<span class="co">#&gt; 29 3332.368 496.2  177216</span>
<span class="co">#&gt; 30 3333.933 496.2  148544</span>
<span class="co">#&gt; 31 3335.498 496.2  119240</span>
<span class="co">#&gt; 32 3337.063 496.2   94736</span>
<span class="co">#&gt; 33 3338.628 496.2   76832</span>
<span class="co">#&gt; 34 3340.193 496.2   64048</span>
<span class="co">#&gt; 35 3341.758 496.2   53744</span>
<span class="co">#&gt; 36 3343.323 496.2   45704</span>
<span class="co">#&gt; 37 3344.888 496.2   39576</span>
<span class="co">#&gt; 38 3346.453 496.2   35080</span>
<span class="co">#&gt; 39 3348.018 496.2   31432</span>
<span class="co">#&gt; 40 3349.583 496.2   28904</span>
<span class="co">#&gt; 41 3351.148 496.2   27064</span>
<span class="co">#&gt; 42 3352.713 496.2   25632</span>
<span class="co">#&gt; 43 3354.278 496.2   24480</span>
<span class="co">#&gt; 44 3355.843 496.2   23840</span>
<span class="co">#&gt; 45 3357.408 496.2   23688</span>
<span class="co">#&gt; 46 3358.973 496.2   24680</span>
<span class="co">#&gt; 47 3360.538 496.2   28608</span>
<span class="co">#&gt; 48 3362.102 496.2   39616</span>
<span class="co">#&gt; 49 3363.667 496.2   63344</span>
<span class="co">#&gt; 50 3365.232 496.2  107352</span>
<span class="co">#&gt; 51 3366.797 496.2  182144</span>
<span class="co">#&gt; 52 3368.362 496.2  295232</span>
<span class="co">#&gt; 53 3369.927 496.2  438016</span>
<span class="co">#&gt; 54 3371.492 496.2  592256</span>
<span class="co">#&gt; 55 3373.057 496.2  737408</span>
<span class="co">#&gt; 56 3374.622 496.2  858624</span>
<span class="co">#&gt; 57 3376.187 496.2  938368</span>
<span class="co">#&gt; 58 3377.752 496.2  982976</span>
<span class="co">#&gt; 59 3379.317 496.2 1015232</span>
<span class="co">#&gt; 60 3380.882 496.2 1057280</span>
<span class="co">#&gt; 61 3382.447 496.2 1095680</span>
<span class="co">#&gt; 62 3384.012 496.2 1122304</span>
<span class="co">#&gt; 63 3385.577 496.2 1128960</span>
<span class="co">#&gt; 64 3387.142 496.2 1111040</span>
<span class="co">#&gt; 65 3388.707 496.2 1058816</span>
<span class="co">#&gt; 66 3390.272 496.2  996608</span>
<span class="co">#&gt; 67 3391.837 496.2  942272</span>
<span class="co">#&gt; 68 3393.402 496.2  888640</span>
<span class="co">#&gt; 69 3394.966 496.2  820160</span>
<span class="co">#&gt; 70 3396.531 496.2  744448</span>
<span class="co">#&gt; 71 3398.096 496.2  674688</span>
<span class="co">#&gt; 72 3399.661 496.2  609600</span>
<span class="co">#&gt; 73 3401.226 496.2  543552</span>
<span class="co">#&gt; 74 3402.791 496.2  480896</span>
<span class="co">#&gt; 75 3404.356 496.2  428032</span>
<span class="co">#&gt; 76 3405.921 496.2  387520</span>
<span class="co">#&gt; 77 3407.486 496.2  350976</span>
<span class="co">#&gt; 78 3409.051 496.2  313984</span>
<span class="co">#&gt; 79 3410.616 496.2  276224</span>
<span class="co">#&gt; 80 3412.181 496.2  243776</span>
<span class="co">#&gt; 81 3413.746 496.2  219264</span>
<span class="co">#&gt; 82 3415.311 496.2  202368</span>
<span class="co">#&gt; 83 3416.876 496.2  189184</span>
<span class="co">#&gt; 84 3418.441 496.2  174272</span>
<span class="co">#&gt; 85 3420.006 496.2  158080</span>
<span class="co">#&gt; 86 3421.571 496.2  143744</span>
<span class="co">#&gt; 87 3423.136 496.2  135808</span>
<span class="co">#&gt; 88 3424.701 496.2  131648</span>
<span class="co">#&gt; 89 3426.266 496.2  126784</span>
<span class="co">#&gt; 90 3427.831 496.2  118328</span>
<span class="co">#&gt; 91 3429.395 496.2  109144</span>
<span class="co">#&gt; 92 3430.960 496.2  101944</span>
<span class="co">#&gt; 93 3432.525 496.2   96896</span>
<span class="co">#&gt; 94 3434.090 496.2   92048</span>
<span class="co">#&gt; 95 3435.655 496.2   86408</span>
<span class="co">#&gt; 96 3437.220 496.2   81288</span>
<span class="co">#&gt; 97 3438.785 496.2   78144</span></code></pre></div>
<p><code><a href="../reference/peakPantheR_singleFileSearch.html">peakPantheR_singleFileSearch()</a></code> takes multiple parameters that can alter the file annotation:</p>
<ul>
<li>
<code>peakStatistic</code> if <code>TRUE</code> calculates additional peak statistics: <em>‘ppm_error’</em>, <em>‘rt_dev_sec’</em>, <em>‘tailing factor’</em> and <em>‘asymmetry factor’</em>
</li>
<li>
<code>plotEICsPath</code> if not <code>NA</code> will save a <code>.png</code> of all ROI EICs at the path provided (expects <code>'filepath/filename.png'</code> for example). If <code>NA</code> no plot is saved</li>
<li>
<code>getAcquTime</code> if <code>TRUE</code> the sample acquisition date-time is extracted from the <code>mzML</code> metadata. Acquisition time cannot be extracted from other file formats. The additional file access will impact run time</li>
<li>
<code>FIR</code> if not <code>NULL</code>, defines the Fallback Integration Regions (<strong>FIR</strong>) to integrate when a feature is not found.</li>
<li>
<code>curveModel</code>, defines the peak-shape model to fit to each EIC. By default, a <em>‘skewedGaussian’</em> model is used. The other alternative is the exponentially modified gaussian <em>‘emgGaussian’</em> model.</li>
<li>
<code>verbose</code> if <code>TRUE</code> messages calculation progress, time taken and number of features found (<em>total and matched to targets</em>)</li>
<li>
<code>...</code> passes arguments to <code>findTargetFeatures</code> to alter peak-picking parameters (e.g. the curveModel, the sampling or fitting parameters)</li>
</ul>
<p>The summary plot generated by <code>plotEICsPath</code>, corresponding to the EICs of each integrated regions of interest is as follow: <img src="../man/figures/singleFileSearch_EICsPlot.png" width="700px"></p>
<blockquote>
<p>EICs plot: Each panel correspond to a targeted feature, with the EIC extracted on the <code>mzMin</code>, <code>mzMax</code> range found. The red dot marks the RT peak apex, and the red line highlights the RT peakwidth range found (<code>rtMin</code>, <code>rtMax</code>)</p>
</blockquote>
</div>
</div>
<div id="see-also" class="section level1">
<h1 class="hasAnchor">
<a href="#see-also" class="anchor" aria-hidden="true"></a>See Also</h1>
<ul>
<li><a href="getting-started.html">Getting Started with peakPantheR</a></li>
<li><a href="parallel-annotation.html">Parallel Annotation</a></li>
<li><a href="peakPantheR-GUI.html">Graphical user interface use</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Arnaud Wolfer, Goncalo Correia.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
