<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate chromatographic peak properties — getTargetFeatureStatistic • peakPantheR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate chromatographic peak properties — getTargetFeatureStatistic"><meta property="og:description" content="Calculate the ppm error, retention time deviation, tailing
factor and asymmetry factor for each measured feature."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">peakPantheR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.16.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting-started.html">Getting Started with the peakPantheR package</a>
    </li>
    <li>
      <a href="../articles/parallel-annotation.html">Parallel Annotation</a>
    </li>
    <li>
      <a href="../articles/peakPantheR-GUI.html">peakPantheR Graphical User Interface</a>
    </li>
    <li>
      <a href="../articles/real-time-annotation.html">Real Time Annotation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/phenomecentre/peakPantheR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate chromatographic peak properties</h1>
    <small class="dont-index">Source: <a href="https://github.com/phenomecentre/peakPantheR/blob/HEAD/R/getTargetFeatureStatistic.R" class="external-link"><code>R/getTargetFeatureStatistic.R</code></a></small>
    <div class="hidden name"><code>getTargetFeatureStatistic.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the ppm error, retention time deviation, tailing
factor and asymmetry factor for each measured feature.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getTargetFeatureStatistic</span><span class="op">(</span></span>
<span>    <span class="va">fittedCurves</span>,</span>
<span>    <span class="va">targetFeatTable</span>,</span>
<span>    <span class="va">foundPeakTable</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fittedCurves</dt>
<dd><p>(list) A list (one entry per ROI window) of
<code>peakPantheR_curveFit</code> or NA</p></dd>


<dt>targetFeatTable</dt>
<dd><p>a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> of compounds to target as
rows. Columns: <code>cpdID</code> (str), <code>cpdName</code> (str), <code>rtMin</code> (float
in seconds), <code>rt</code> (float in seconds, or <em>NA</em>), <code>rtMax</code> (float
in seconds), <code>mzMin</code> (float), <code>mz</code> (float or <em>NA</em>),
<code>mzMax</code> (float).</p></dd>


<dt>foundPeakTable</dt>
<dd><p>a <code>data.frame</code> as generated by
<code><a href="findTargetFeatures.html">findTargetFeatures</a></code>, with features as rows and peak properties
as columns. The following columns are mandatory: <code>mzMin</code>, <code>mz</code>,
<code>mzMax</code>, <code>rtMin</code>, <code>rt</code>, <code>rtMax</code></p></dd>


<dt>verbose</dt>
<dd><p>(bool) if TRUE message when NA scans are removed</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>data.frame</code> with measured compounds as rows and measurements
and properties as columns (see Details).</p>


<div class="section">
<h3 id="details-">Details:<a class="anchor" aria-label="anchor" href="#details-"></a></h3>
<p>The returned <code>data.frame</code> is structured as follow:</p><table class="table table"><tr><td>found</td><td>was the peak found</td></tr><tr><td>rt</td><td>retention time of peak apex (sec)</td></tr><tr><td>rtMin</td><td>leading edge of peak retention time (sec) determined at 0.5% of
apex intensity</td></tr><tr><td>rtMax</td><td>trailing edge of peak retention time (sec) determined at 0.5% of
apex intensity</td></tr><tr><td>mz</td><td>weighted (by intensity) mean of peak m/z across scans</td></tr><tr><td>mzMin</td><td>m/z peak minimum (between rtMin, rtMax)</td></tr><tr><td>mzMax</td><td>m/z peak maximum (between rtMin, rtMax)</td></tr><tr><td>peakArea</td><td>integrated peak area</td></tr><tr><td>peakAreaRaw</td><td>integrated peak area from raw data points</td></tr><tr><td>maxIntMeasured</td><td>maximum peak intensity in raw data</td></tr><tr><td>maxIntPredicted</td><td>maximum peak intensity based on curve fit</td></tr><tr><td>ppm_error</td><td>difference in ppm between the expected and measured m/z</td></tr><tr><td>rt_dev_sec</td><td>difference in seconds between the expected and measured rt</td></tr><tr><td>tailingFactor</td><td>the tailing factor is a measure of peak tailing. It is
defined as the distance from the front slope of the peak to the back slope
divided by twice the distance from the center line of the peak to the front
slope, with all measurements made at 5% of the maximum peak height. The
tailing factor of a peak will typically be similar to the asymmetry factor
for the same peak, but the two values cannot be directly converted</td></tr><tr><td>asymmetryFactor</td><td>the asymmetry factor is a measure of peak tailing. It is
defined as the distance from the center line of the peak to the back slope
divided by the distance from the center line of the peak to the front slope,
with all measurements made at 10% of the maximum peak height. The asymmetry
factor of a peak will typically be similar to the tailing factor for the same
peak, but the two values cannot be directly converted</td></tr></table></div>


    </div>
    <div id="details">
    <h2>Details</h2>
    <p>## Examples cannot be computed as the function is not exported:
# fittedCurve
cFit1 &lt;- list(amplitude=162404.8057918259, center=3341.888,
                sigma=0.078786133031045896, gamma=0.0018336101984172684,
                fitStatus=2, curveModel='skewedGaussian')
class(cFit1) &lt;- 'peakPantheR_curveFit'
cFit2        &lt;- list(amplitude=199249.10572753669, center=3382.577,
                    sigma=0.074904415304607966, gamma=0.0011471899372353885,
                    fitStatus=2, curveModel='skewedGaussian')
class(cFit2)    &lt;- 'peakPantheR_curveFit'
input_fitCurves &lt;- list(cFit1, cFit2)</p>
<p># ROI
input_ROI &lt;- data.frame(matrix(vector(), 2, 8, dimnames=list(c(), c('cpdID',
                'cpdName', 'rtMin', 'rt', 'rtMax', 'mzMin', 'mz', 'mzMax'))),
                stringsAsFactors=FALSE)
input_ROI[1,] &lt;- c('ID-1', 'testCpd 1', 3310., 3344.88, 3390., 522.19, 522.2,
                    522.21)
input_ROI[2,] &lt;- c('ID-2', 'testCpd 2', 3280., 3385.58, 3440., 496.19, 496.2,
                    496.21)
input_ROI[,3:8] &lt;- vapply(input_ROI[,3:8], as.numeric, FUN.VALUE=numeric(2))</p>
<p># foundPeakTable
input_foundPeakTable &lt;- data.frame(matrix(vector(), 2, 10, dimnames=list(c(),
                    c('found', 'rtMin', 'rt', 'rtMax', 'mzMin', 'mz',
                    'mzMax','peakArea','maxIntMeasured','maxIntPredicted'))),
                    stringsAsFactors=FALSE)
input_foundPeakTable[1,]  &lt;- c(TRUE, 3309.758, 3346.827, 3385.410, 522.19,
                                522.2, 522.21, 26133726, 889280, 901015)
input_foundPeakTable[2,]  &lt;- c(TRUE, 3345.376, 3386.529, 3428.279, 496.19,
                                496.2, 496.21, 35472141, 1128960, 1113576)
input_foundPeakTable[,1]  &lt;- vapply(input_foundPeakTable[,c(1)], as.logical,
                                FUN.VALUE=logical(1))</p>
<p># Run peak statistics
peakStatistics &lt;- getTargetFeatureStatistic(input_fitCurves, input_ROI,
                                            input_foundPeakTable)
peakStatistics   
#   found    rtMin       rt    rtMax  mzMin    mz  mzMax peakArea
# 1  TRUE 3309.758 3346.827 3385.410 522.19 522.2 522.21 26133726
# 2  TRUE 3345.376 3386.529 3428.279 496.19 496.2 496.21 35472141
#    maxIntMeasured maxIntPredicted ppm_error rt_dev_sec tailingFactor
# 1          889280          901015         0      1.947      1.015385
# 2         1128960         1113576         0      0.949      1.005372
#    asymmetryFactor
# 1         1.026886
# 2         1.009304</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Arnaud Wolfer, Goncalo Correia.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

